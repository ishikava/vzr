"use strict";function ownKeys(t,e){var n,i=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,n)),i}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}var Select=function(){function n(e,t){_classCallCheck(this,n),this.$element=$(e),this.$tags=this.$element.parents(".form__row").find(".js-select2-tags"),this.params=t,this.init(),this.setListeners()}return _createClass(n,[{key:"init",value:function(){var e,t={placeholder:this.$element.attr("data-placeholder"),dropdownParent:this.$element.parent(),theme:"width-100",formatSearching:null,language:{noResults:function(){return"Ничего не найдено"},inputTooShort:function(){return!1},searching:function(){return null}}};this.$element.is("[data-html]")&&(t.templateResult=e=function(e){if(!e.element)return"";e=$(e.element).data("html");return $(e)},t.templateSelection=e),this.params&&(t=_objectSpread(_objectSpread({},t),this.params)),this.$element.hasClass("js-select2--link")&&(t.theme="like-link",this.$element.hasClass("js-select2--gray")&&(t.theme+=" is-gray")),this.$element.attr("multiple")&&(t.multiple=!0),this.$element.data("multiple-search")&&(t.minimumInputLength=2),this.$element.select2(t)}},{key:"setListeners",value:function(){var t,n,i=this;this.$element.on("change",function(e){i.$element.valid&&i.$element.valid()}),this.$tags.length&&this.$tags.on("click","a",function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-select-value"),e=i.$element.val();e.push(t),i.$element.val(e).trigger("change")}),this.$element.attr("multiple")&&this.$element.on("select2:unselect",function(e){var t=$(e.currentTarget).next(".select2").find(".select2-search__field");setTimeout(function(){t.focus()},0)}),this.$element.on("select2:open",function(e){$(e.currentTarget);var t,n=$(".select2-container:visible"),e=n.find(".select2-selection"),i=n.find(".select2-dropdown");e.on("keyup",function(){clearTimeout(t),t=setTimeout(function(){var e=$(".select2-results__option--highlighted");Scrollbar.has(i[0])&&e.length&&Scrollbar.get(i[0]).scrollIntoView(e[0],{alignToTop:!1,onlyScrollIfNeeded:!1})},50)})}),this.$element.data("multiple-search")&&(t=this.$element,n=this.$element.closest(".js-input").find(".js-select2-clear"),t.on("select2:open",function(e){$(e.currentTarget);var t=$(".select2-container:visible"),e=t.find(".select2-search__field"),n=(t.find(".select2-results"),t.find(".select2-dropdown"));e.val().length<=2&&n.hide(),e.on("keyup",function(){2<=$(this).val().length?n.show():n.hide()})}),t.on("select2:select change.select2",function(e){var e=$(e.currentTarget),t=e.next(".select2").find(".select2-search__field");setTimeout(function(){t.focus()},0),n.toggleClass("is-active",1<e.val().length)}),t.on("select2:unselect",function(e){t.val()||n.removeClass("is-active")}),n.on("click",function(e){t.val("").trigger("change"),n.removeClass("is-active")}))}},{key:"addOptionFromArray",value:function(e){var t=this;$.map(e,function(e){e=new Option(e.text,e.id,!1,!1);t.$element.append(e)})}}]),n}();window.initSelect2=function(e){(e=e||$(document)).find(".js-select2").each(function(e,t){return new Select(t)})},$(function(){window.initSelect2()});